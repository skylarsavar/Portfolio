# In this analysis I have used an e-commerce dataset to find out which products are doing the best, which locations are the most loyal and what time of year is the best
# for sales using bigquery under the project name zeta-time-396120.sales_data.sales

# Removing columns that won't be used during analysis. 
ALTER TABLE zeta-time-396120.sales_data.sales
DROP COLUMN int64_field_0

# Check for null values 
SELECT *
FROM `zeta-time-396120.sales_data.sales` 
WHERE Order_ID IS NOT NULL
AND Product IS NOT NULL
AND Quantity_Ordered IS NOT NULL
AND Price_Each IS NOT NULL
AND Order_Date IS NOT NULL
AND Purchase_Address IS NOT NULL
AND Month IS NOT NULL
AND Sales IS NOT NULL
AND City IS NOT NULL

# How many unique products are being sold 
SELECT count(distinct Product)
FROM `zeta-time-396120.sales_data.sales`

# Analyze the products by price 
SELECT distinct Product, Price_Each
FROM `zeta-time-396120.sales_data.sales`
ORDER BY Price_Each

# Find out what product is the most expensive
SELECT Price_Each, Sales, Product
FROM `zeta-time-396120.sales_data.sales`
ORDER BY Price_Each desc

# Analyze how many times each product was purchased using the Order_Quantity column 
SELECT Product, sum(Quantity_Ordered) as Total_Number_Sold
FROM `zeta-time-396120.sales_data.sales`
GROUP BY Product
ORDER BY sum(Quantity_Ordered) desc

# Find out how much revenue was generated by each product
SELECT Product, round(sum(Quantity_Ordered * Price_Each)) as Total_Revenue
FROM `zeta-time-396120.sales_data.sales`
GROUP BY Product
ORDER BY sum(Quantity_Ordered * Price_Each) desc

# Analyze the total orders by City
SELECT City, count(Order_Id) as Number_Of_Orders
FROM `zeta-time-396120.sales_data.sales`
GROUP BY City
ORDER BY count(Order_Id) desc

# How much did each city spend 
SELECT City, round(sum(Price_Each * Quantity_Ordered)) as Total_Revenue 
FROM `zeta-time-396120.sales_data.sales`
GROUP BY City
ORDER BY round(sum(Price_Each*Quantity_Ordered)) desc

# What months did the best in sales
SELECT CASE Month
  WHEN 12 THEN 'December'
  WHEN 11 THEN 'November'
  WHEN 10 THEN 'October'
  WHEN 9 THEN 'September'
  WHEN 8 THEN 'August'
  WHEN 7 THEN 'July'
  WHEN 6 THEN 'June'
  WHEN 5 THEN 'May'
  WHEN 4 THEN 'April'
  WHEN 3 THEN 'March'
  WHEN 2 THEN 'February'
  WHEN 1 THEN 'January'
  ELSE 'not available'
END AS Month, round(sum(Price_Each * Quantity_Ordered)) as Total_Revenue 
FROM `zeta-time-396120.sales_data.sales`
GROUP BY Month

# Findings 
# Out of all of the products sold, MacBook Pros make the most in revenue each year.
# Users' shopping habits increase significantly during the holiday season.
# San Francisco contains the most loyal customers, making the most orders and contributing the most in revenue each year. 

# Recommendations 
# Offer promotions throughout the year when sales are low to incentivize customers to utilize your services consistently year round. 
# The Marketing team could create targeted marketing campaigns for locations that had lower purchase rates. 

# From this analysis, these insights could be used for a variety of marketing and business processing purposes.
# Knowing which locations are the most loyal and which do not purchase from them as often could be used to create marketing campaigns for those specific areas. 
# Additionally knowing which products are doing the best could allow the company to plan inventory and add or remove products. 
# Finally, knowing which time of year does the best in sales could help the company increase revenue by implementing new strategies during the low seasons. 
# Now that we know which months have the least amount of sales we can figure out why. 
